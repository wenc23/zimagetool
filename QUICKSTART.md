# Z-Image-Turbo Flask Web UI - 快速开始指南

## 📋 前提条件

1. **Python 3.8+** 已安装
2. **虚拟环境已创建** (venv目录)
3. **模型已下载** (models/Z-Image-Turbo)
4. **依赖已安装**

## 🚀 启动步骤

### 方法1: 使用启动脚本 (推荐)

#### Windows:
```bash
start_flask.bat
```

#### Linux/Mac:
```bash
./start_flask.sh
```

### 方法2: 手动启动

#### Windows:
```bash
# 1. 激活虚拟环境
venv\Scripts\activate

# 2. 运行Flask应用
python flask_app.py

# 3. 退出虚拟环境
deactivate
```

#### Linux/Mac:
```bash
# 1. 激活虚拟环境
source venv/bin/activate

# 2. 运行Flask应用
python flask_app.py

# 3. 退出虚拟环境
deactivate
```

## 🌐 访问应用

启动成功后，在浏览器中访问:
```
http://localhost:5000
```

## ⚙️ 首次使用

1. **加载模型**
   - 在Web界面中选择优化模式
   - 点击"加载模型"按钮
   - 等待模型加载完成

2. **输入提示词**
   - 在"图片描述"框中输入您想要的图片描述
   - 支持中英文

3. **配置优化** (可选)
   - 展开"提示词优化配置"
   - 填写画风、人物、背景等详细信息
   - 点击"预览优化效果"查看优化后的提示词
   - 可以编辑优化后的提示词

4. **生成图片**
   - 设置图片尺寸、步数等参数
   - 点击"生成图片"按钮
   - 观察实时进度条
   - 等待图片生成完成

5. **保存和管理**
   - 图片自动保存到gallery目录
   - 点击"下载图片"保存到本地
   - 点击"查看画廊"浏览所有生成的图片

## 🔧 配置说明

### 环境变量配置

创建 `.env` 文件或设置环境变量:

```bash
# 模型路径
MODEL_PATH=models/Z-Image-Turbo

# DeepSeek API密钥 (可选，用于提示词优化)
DEEPSEEK_API_KEY=your_api_key_here

# Flask配置
FLASK_HOST=0.0.0.0
FLASK_PORT=5000
FLASK_DEBUG=False

# 图片生成默认配置
DEFAULT_WIDTH=1024
DEFAULT_HEIGHT=1024
DEFAULT_STEPS=9
DEFAULT_FILENAME=generated_image.png

# 画廊目录
GALLERY_DIR=gallery
```

## 📊 功能特性

### ✨ 核心功能
- ✅ **Flask Web UI** - 现代化Web界面
- ✅ **中文编码支持** - 完美支持UTF-8
- ✅ **提示词优化** - AI智能优化提示词
- ✅ **实时进度条** - 可视化生成进度
- ✅ **图片预览** - 高质量图片显示
- ✅ **响应式设计** - 支持移动端

### 🎨 提示词优化功能
- 画风描述 (日系动漫、写实油画等)
- 人物描述 (年龄、性别、特征)
- 姿势描述 (坐、立、跳等)
- 背景描述 (场景、环境)
- 服饰描述 (服装风格)
- 光照描述 (光线效果)
- 构图描述 (全景、特写等)
- 其他细节 (表情、道具等)

### 💡 优化模式
- **基础优化**: 平衡性能和显存使用
- **低显存优化**: 适合显存较小的设备

## 🛠️ 故障排除

### 问题1: 模型加载失败
**解决方法:**
- 检查模型路径是否正确
- 确认模型文件完整下载
- 检查CUDA是否正确安装
- 尝试使用低显存优化模式

### 问题2: 图片生成失败
**解决方法:**
- 检查GPU显存是否足够
- 降低图片尺寸或步数
- 使用低显存优化模式
- 查看错误日志获取详细信息

### 问题3: 提示词优化失败
**解决方法:**
- 检查DeepSeek API密钥是否设置
- 确认网络连接正常
- 可以禁用提示词优化直接使用原始提示词

### 问题4: 中文乱码
**解决方法:**
- 已修复: Flask配置了UTF-8编码
- 确保浏览器编码设置为UTF-8
- 检查终端编码设置

## 📝 技术栈

- **后端**: Flask + Python
- **前端**: HTML5 + CSS3 + JavaScript
- **AI模型**: Z-Image-Turbo
- **优化**: DeepSeek API (可选)

## 📞 获取帮助

如遇问题，请查看:
1. README.md - 项目说明
2. CHANGELOG.md - 更新日志
3. 控制台错误日志

## ⚠️ 注意事项

1. **首次加载模型需要较长时间**，请耐心等待
2. **生成大图片需要更多显存**，建议从1024x1024开始
3. **步数推荐8-10步**，过多步数不会明显提升质量
4. **定期清理gallery目录**以节省磁盘空间

---

**祝您使用愉快！** 🎉
